{"version":3,"file":"background.js","sourceRoot":"","sources":["background.ts"],"names":[],"mappings":"AAAA;;;;;;GAMG;AAKH,OAAO,EAAC,UAAU,EAAO,MAAM,eAAe,CAAC;AAE/C,SAAS,YAAY,CAAC,EAAoB;IACxC,IAAI,CAAC,EAAE,CAAC,SAAS,EAAE,CAAC;QAClB,OAAO,kBAAkB,CAAC;IAC5B,CAAC;IACD,IAAI,CAAC,EAAE,CAAC,KAAK,IAAI,CAAC,EAAE,CAAC,yBAAyB,EAAE,CAAC;QAC/C,OAAO,kBAAkB,CAAC;IAC5B,CAAC;IACD,IAAI,CAAC,EAAE,CAAC,WAAW,EAAE,CAAC;QACpB,OAAO,iBAAiB,CAAC;IAC3B,CAAC;IACD,OAAO,gBAAgB,CAAC;AAC1B,CAAC;AAED,IAAI,MAAM,KAAK,SAAS,IAAI,MAAM,CAAC,OAAO,KAAK,SAAS,EAAE,CAAC;IACzD,MAAM,YAAY,GAAG,MAAM,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC,gBAAgB,KAAK,CAAC,CAAC;IAEzE,MAAM,aAAa,GAAG,CAAC,GAAG,EAAE;QAC1B,iDAAiD;QACjD,uDAAuD;QACvD,MAAM,UAAU,GAAG,EAAC,OAAO,EAAE,GAAG,EAAE,GAAE,CAAC,EAAE,QAAQ,EAAE,GAAG,EAAE,GAAE,CAAC,EAAC,CAAC;QAE3D,IAAI,YAAY,EAAE,CAAC;YACjB,OAAO,MAAM,CAAC,MAAM,IAAI,UAAU,CAAC;QACrC,CAAC;QAED,OAAO,MAAM,CAAC,aAAa,IAAI,UAAU,CAAC;IAC5C,CAAC,CAAC,EAAE,CAAC;IAEL,2CAA2C;IAC3C,iDAAiD;IACjD,aAAa,CAAC,OAAO,CACnB;QACE,IAAI,EAAE;YACJ,EAAE,EAAE,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,sBAAsB,CAAC;YACjD,EAAE,EAAE,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,sBAAsB,CAAC;YACjD,GAAG,EAAE,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,uBAAuB,CAAC;SACpD;KACF,EACD,GAAG,EAAE,GAAE,CAAC,CACT,CAAC;IAEF,MAAM,CAAC,OAAO,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,GAAqB,EAAE,MAAM,EAAE,EAAE;QACrE,IAAI,CAAC,GAAG,CAAC,iBAAiB,EAAE,CAAC;YAC3B,OAAO;QACT,CAAC;QAED,IAAI,MAAM,IAAI,MAAM,CAAC,GAAG,EAAE,CAAC;YACzB,aAAa,CAAC,QAAQ,CAAC;gBACrB,KAAK,EAAE,MAAM,CAAC,GAAG,CAAC,EAAE;gBACpB,KAAK,EAAE,UAAU,YAAY,CAAC,GAAG,CAAC,EAAE;aACrC,CAAC,CAAC;QACL,CAAC;QAED,IAAI,MAAM,IAAI,MAAM,CAAC,GAAG,IAAI,GAAG,CAAC,SAAS,EAAE,CAAC;YAC1C,aAAa,CAAC,OAAO,CACnB;gBACE,KAAK,EAAE,MAAM,CAAC,GAAG,CAAC,EAAE;gBACpB,IAAI,EAAE;oBACJ,EAAE,EAAE,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,mBAAmB,CAAC;oBAC9C,EAAE,EAAE,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,mBAAmB,CAAC;oBAC9C,GAAG,EAAE,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,oBAAoB,CAAC;iBACjD;aACF,EACD,GAAG,EAAE,GAAE,CAAC,CACT,CAAC;QACJ,CAAC;IACH,CAAC,CAAC,CAAC;IAEH,MAAM,IAAI,GAAG,EAAE,CAAC;IAChB,UAAU,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;AAC9B,CAAC","sourcesContent":["/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\n/// <reference types=\"chrome\"/>\n\nimport {AngularDetection} from '../../../protocol';\nimport {TabManager, Tabs} from './tab_manager';\n\nfunction getPopUpName(ng: AngularDetection): string {\n  if (!ng.isAngular) {\n    return 'not-angular.html';\n  }\n  if (!ng.isIvy || !ng.isSupportedAngularVersion) {\n    return 'unsupported.html';\n  }\n  if (!ng.isDebugMode) {\n    return 'production.html';\n  }\n  return 'supported.html';\n}\n\nif (chrome !== undefined && chrome.runtime !== undefined) {\n  const isManifestV3 = chrome.runtime.getManifest().manifest_version === 3;\n\n  const browserAction = (() => {\n    // Electron does not expose browserAction object,\n    // Use empty calls as fallback if they are not defined.\n    const noopAction = {setIcon: () => {}, setPopup: () => {}};\n\n    if (isManifestV3) {\n      return chrome.action || noopAction;\n    }\n\n    return chrome.browserAction || noopAction;\n  })();\n\n  // By default use the black and white icon.\n  // Replace it only when we detect an Angular app.\n  browserAction.setIcon(\n    {\n      path: {\n        16: chrome.runtime.getURL(`assets/icon-bw16.png`),\n        48: chrome.runtime.getURL(`assets/icon-bw48.png`),\n        128: chrome.runtime.getURL(`assets/icon-bw128.png`),\n      },\n    },\n    () => {},\n  );\n\n  chrome.runtime.onMessage.addListener((req: AngularDetection, sender) => {\n    if (!req.isAngularDevTools) {\n      return;\n    }\n\n    if (sender && sender.tab) {\n      browserAction.setPopup({\n        tabId: sender.tab.id,\n        popup: `popups/${getPopUpName(req)}`,\n      });\n    }\n\n    if (sender && sender.tab && req.isAngular) {\n      browserAction.setIcon(\n        {\n          tabId: sender.tab.id,\n          path: {\n            16: chrome.runtime.getURL(`assets/icon16.png`),\n            48: chrome.runtime.getURL(`assets/icon48.png`),\n            128: chrome.runtime.getURL(`assets/icon128.png`),\n          },\n        },\n        () => {},\n      );\n    }\n  });\n\n  const tabs = {};\n  TabManager.initialize(tabs);\n}\n"]}