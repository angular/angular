{"version":3,"file":"highlighter.js","sourceRoot":"","sources":["highlighter.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport type {Type} from '@angular/core';\nimport {HydrationStatus} from '../../../protocol';\nimport {ngDebugClient} from './ng-debug-api/ng-debug-api';\n\nlet hydrationOverlayItems: HTMLElement[] = [];\nlet selectedElementOverlay: HTMLElement | null = null;\nlet selectedElement: Node | null = null;\n\nconst DEV_TOOLS_HIGHLIGHT_NODE_ID = '____ngDevToolsHighlight';\n\nconst OVERLAY_CONTENT_MARGIN = 4;\nconst MINIMAL_OVERLAY_CONTENT_SIZE = {\n  width: 30 + OVERLAY_CONTENT_MARGIN * 2,\n  height: 20 + OVERLAY_CONTENT_MARGIN * 2,\n};\n\ntype RgbColor = readonly [red: number, green: number, blue: number];\nconst COLORS = {\n  blue: [104, 182, 255],\n  red: [255, 0, 64],\n  grey: [128, 128, 128],\n} satisfies Record<string, RgbColor>;\n\n// Those are the SVG we inline in case the overlay label is to long for the container component.\nconst HYDRATION_SVG = `\n<svg xmlns=\"http://www.w3.org/2000/svg\" enable-background=\"new 0 0 24 24\" height=\"24px\" viewBox=\"0 0 24 24\" width=\"24px\" fill=\"#000000\"><rect fill=\"none\" height=\"24\" width=\"24\"/><path d=\"M12,2c-5.33,4.55-8,8.48-8,11.8c0,4.98,3.8,8.2,8,8.2s8-3.22,8-8.2C20,10.48,17.33,6.55,12,2z M12,20c-3.35,0-6-2.57-6-6.2 c0-2.34,1.95-5.44,6-9.14c4.05,3.7,6,6.79,6,9.14C18,17.43,15.35,20,12,20z M7.83,14c0.37,0,0.67,0.26,0.74,0.62 c0.41,2.22,2.28,2.98,3.64,2.87c0.43-0.02,0.79,0.32,0.79,0.75c0,0.4-0.32,0.73-0.72,0.75c-2.13,0.13-4.62-1.09-5.19-4.12 C7.01,14.42,7.37,14,7.83,14z\"/></svg>`;\nconst HYDRATION_SKIPPED_SVG = `<svg xmlns=\"http://www.w3.org/2000/svg\" enable-background=\"new 0 0 24 24\" height=\"24\" viewBox=\"0 0 24 24\" width=\"24\"><rect fill=\"none\" height=\"24\" width=\"24\"/><path d=\"M21.19,21.19L2.81,2.81L1.39,4.22l4.2,4.2c-1,1.31-1.6,2.94-1.6,4.7C4,17.48,7.58,21,12,21c1.75,0,3.36-0.56,4.67-1.5 l3.1,3.1L21.19,21.19z M12,19c-3.31,0-6-2.63-6-5.87c0-1.19,0.36-2.32,1.02-3.28L12,14.83V19z M8.38,5.56L12,2l5.65,5.56l0,0 C19.1,8.99,20,10.96,20,13.13c0,1.18-0.27,2.29-0.74,3.3L12,9.17V4.81L9.8,6.97L8.38,5.56z\"/></svg>`;\nconst HYDRATION_ERROR_SVG = `<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24\" viewBox=\"0 0 24 24\" width=\"24\"><path d=\"M11 15h2v2h-2v-2zm0-8h2v6h-2V7zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z\"/></svg>`;\n\nfunction createOverlay(color: RgbColor): {overlay: HTMLElement; overlayContent: HTMLElement} {\n  const overlay = document.createElement('div');\n  overlay.className = 'ng-devtools-overlay';\n  overlay.style.backgroundColor = toCSSColor(...color, 0.35);\n  overlay.style.position = 'absolute';\n  overlay.style.zIndex = '2147483647';\n  overlay.style.pointerEvents = 'none';\n  overlay.style.display = 'flex';\n  overlay.style.borderRadius = '3px';\n  overlay.id = DEV_TOOLS_HIGHLIGHT_NODE_ID;\n  const overlayContent = document.createElement('div');\n  overlayContent.style.backgroundColor = toCSSColor(...color, 0.9);\n  overlayContent.style.position = 'absolute';\n  overlayContent.style.fontFamily = 'monospace';\n  overlayContent.style.fontSize = '11px';\n  overlayContent.style.padding = '2px 3px';\n  overlayContent.style.borderRadius = '3px';\n  overlayContent.style.color = 'white';\n  overlay.appendChild(overlayContent);\n  return {overlay, overlayContent};\n}\n\nexport function findComponentAndHost(el: Node | undefined): {\n  component: any;\n  host: HTMLElement | null;\n} {\n  const ng = ngDebugClient();\n  if (!el) {\n    return {component: null, host: null};\n  }\n  while (el) {\n    const component = el instanceof HTMLElement && ng.getComponent!(el);\n    if (component) {\n      return {component, host: el as HTMLElement};\n    }\n    if (!el.parentElement) {\n      break;\n    }\n    el = el.parentElement;\n  }\n  return {component: null, host: null};\n}\n\n// Todo(aleksanderbodurri): this should not be part of the highlighter, move this somewhere else\nexport function getDirectiveName(dir: Type<unknown> | undefined | null): string {\n  return dir ? dir.constructor.name : 'unknown';\n}\n\nexport function highlightSelectedElement(el: Node): void {\n  if (el === selectedElement) {\n    return;\n  }\n  unHighlight();\n  selectedElementOverlay = addHighlightForElement(el);\n  selectedElement = el;\n}\n\nexport function highlightHydrationElement(el: Node, status: HydrationStatus) {\n  let overlay: HTMLElement | null = null;\n  if (status?.status === 'skipped') {\n    overlay = addHighlightForElement(el, COLORS.grey, status?.status);\n  } else if (status?.status === 'mismatched') {\n    overlay = addHighlightForElement(el, COLORS.red, status?.status);\n  } else if (status?.status === 'hydrated') {\n    overlay = addHighlightForElement(el, COLORS.blue, status?.status);\n  }\n\n  if (overlay) {\n    hydrationOverlayItems.push(overlay);\n  }\n}\n\nexport function unHighlight(): void {\n  if (!selectedElementOverlay) {\n    return;\n  }\n\n  for (const node of document.body.childNodes) {\n    if (node === selectedElementOverlay) {\n      document.body.removeChild(selectedElementOverlay);\n\n      break;\n    }\n  }\n\n  selectedElementOverlay = null;\n}\n\nexport function removeHydrationHighlights(): void {\n  hydrationOverlayItems.forEach((overlay) => {\n    document.body.removeChild(overlay);\n  });\n  hydrationOverlayItems = [];\n}\n\nexport function inDoc(node: any): boolean {\n  if (!node) {\n    return false;\n  }\n  const doc = node.ownerDocument.documentElement;\n  const parent = node.parentNode;\n  return (\n    doc === node || doc === parent || !!(parent && parent.nodeType === 1 && doc.contains(parent))\n  );\n}\n\nfunction addHighlightForElement(\n  el: Node,\n  color: RgbColor = COLORS.blue,\n  overlayType?: NonNullable<HydrationStatus>['status'],\n): HTMLElement | null {\n  const cmp = findComponentAndHost(el).component;\n  const rect = getComponentRect(el);\n  if (rect?.height === 0 || rect?.width === 0) {\n    // display nothing in case the component is not visible\n    return null;\n  }\n\n  const {overlay, overlayContent} = createOverlay(color);\n  if (!rect) return null;\n\n  const content: Node[] = [];\n  const componentName = getDirectiveName(cmp);\n\n  // We display an icon inside the overlay if the container computer is wide enough\n  if (overlayType) {\n    if (\n      rect.width > MINIMAL_OVERLAY_CONTENT_SIZE.width &&\n      rect.height > MINIMAL_OVERLAY_CONTENT_SIZE.height\n    ) {\n      // 30x20 + 8px margin\n      const svg = createOverlaySvgElement(overlayType!);\n      content.push(svg);\n    }\n  } else if (componentName) {\n    const middleText = document.createTextNode(componentName);\n    const pre = document.createElement('span');\n    pre.innerText = `<`;\n    const post = document.createElement('span');\n    post.innerText = `>`;\n    content.push(pre, middleText, post);\n  }\n  showOverlay(overlay, overlayContent, rect, content, overlayType ? 'inside' : 'outside');\n  return overlay;\n}\n\nfunction getComponentRect(el: Node): DOMRect | undefined {\n  if (!(el instanceof HTMLElement)) {\n    return;\n  }\n  if (!inDoc(el)) {\n    return;\n  }\n  return el.getBoundingClientRect();\n}\n\nfunction showOverlay(\n  overlay: HTMLElement,\n  overlayContent: HTMLElement,\n  dimensions: DOMRect,\n  content: Node[],\n  labelPosition: 'inside' | 'outside',\n): void {\n  const {width, height, top, left} = dimensions;\n  overlay.style.width = ~~width + 'px';\n  overlay.style.height = ~~height + 'px';\n  overlay.style.top = ~~top + window.scrollY + 'px';\n  overlay.style.left = ~~left + window.scrollX + 'px';\n\n  positionOverlayContent(overlayContent, dimensions, labelPosition);\n  overlayContent.replaceChildren();\n\n  if (content.length) {\n    content.forEach((child) => overlayContent.appendChild(child));\n  } else {\n    // If the overlay label has no content, remove it from the DOM.\n    overlay.removeChild(overlayContent);\n  }\n\n  document.body.appendChild(overlay);\n}\n\nfunction positionOverlayContent(\n  overlayContent: HTMLElement,\n  dimensions: DOMRect,\n  labelPosition: 'inside' | 'outside',\n) {\n  const {innerWidth: viewportWidth, innerHeight: viewportHeight} = window;\n  const style = overlayContent.style;\n  const yOffset = 23;\n  const yOffsetValue = `-${yOffset}px`;\n\n  if (labelPosition === 'inside') {\n    style.top = `${OVERLAY_CONTENT_MARGIN}px`;\n    style.right = `${OVERLAY_CONTENT_MARGIN}px`;\n    return;\n  }\n\n  // Clear any previous positioning styles.\n  style.top = style.bottom = style.left = style.right = '';\n\n  // Attempt to position the content element so that it's always in the\n  // viewport along the Y axis. Prefer to position on the bottom.\n  if (dimensions.bottom + yOffset <= viewportHeight) {\n    style.bottom = yOffsetValue;\n    // If it doesn't fit on the bottom, try to position on top.\n  } else if (dimensions.top - yOffset >= 0) {\n    style.top = yOffsetValue;\n    // Otherwise offset from the bottom until it fits on the screen.\n  } else {\n    style.bottom = `${Math.max(dimensions.bottom - viewportHeight, 0)}px`;\n  }\n\n  // Attempt to position the content element so that it's always in the\n  // viewport along the X axis. Prefer to position on the right.\n  if (dimensions.right <= viewportWidth) {\n    style.right = '0';\n    // If it doesn't fit on the right, try to position on left.\n  } else if (dimensions.left >= 0) {\n    style.left = '0';\n    // Otherwise offset from the right until it fits on the screen.\n  } else {\n    style.right = `${Math.max(dimensions.right - viewportWidth, 0)}px`;\n  }\n}\n\nfunction toCSSColor(red: number, green: number, blue: number, alpha = 1): string {\n  return `rgba(${red},${green},${blue},${alpha})`;\n}\n\nfunction createOverlaySvgElement(type: NonNullable<HydrationStatus>['status']): Node {\n  let icon: string;\n  if (type === 'hydrated') {\n    icon = HYDRATION_SVG;\n  } else if (type === 'mismatched') {\n    icon = HYDRATION_ERROR_SVG;\n  } else if (type === 'skipped') {\n    icon = HYDRATION_SKIPPED_SVG;\n  } else {\n    throw new Error(`No icon specified for type ${type}`);\n  }\n\n  const svg = new DOMParser().parseFromString(icon, 'image/svg+xml').childNodes[0] as SVGElement;\n  svg.style.fill = 'white';\n  svg.style.height = '1.5em';\n  return svg;\n}\n"]}