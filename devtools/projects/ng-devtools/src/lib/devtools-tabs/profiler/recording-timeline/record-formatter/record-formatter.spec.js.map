{"version":3,"file":"record-formatter.spec.js","sourceRoot":"","sources":["record-formatter.spec.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {DirectiveProfile, ElementProfile, ProfilerFrame} from '../../../../../../../protocol';\n\nimport {RecordFormatter} from './record-formatter';\n\nclass MockFormatter extends RecordFormatter<any> {\n  override addFrame(nodes: any[], elements: ElementProfile[]): void {\n    return;\n  }\n\n  override formatFrame(frame: ProfilerFrame): any {\n    return;\n  }\n}\n\nconst formatter = new MockFormatter();\n\ndescribe('getValue cases', () => {\n  let element: any;\n\n  it('calculates value with  no lifecycle hooks', () => {\n    element = {\n      children: [],\n      directives: [\n        {\n          changeDetection: 10,\n          isElement: false,\n          isComponent: true,\n          lifecycle: {},\n          name: 'AppComponent',\n        },\n      ],\n    };\n    expect(formatter.getValue(element)).toBe(10);\n  });\n\n  it('calculates value with 0 change detection and existing lifecycle hooks', () => {\n    element = {\n      children: [],\n      directives: [\n        {\n          isComponent: false,\n          isElement: false,\n          name: 'NgForOf',\n          lifecycle: {ngDoCheck: 5},\n          changeDetection: 0,\n        },\n      ],\n    };\n    expect(formatter.getValue(element)).toBe(5);\n  });\n\n  it('calculates value with non 0 change detection and one lifecycle hook', () => {\n    element = {\n      children: [],\n      directives: [\n        {\n          isComponent: false,\n          isElement: false,\n          name: 'NgForOf',\n          lifecycle: {ngDoCheck: 5},\n          changeDetection: 10,\n        },\n      ],\n    };\n    expect(formatter.getValue(element)).toBe(15);\n  });\n\n  it('calculates value with non 0 change detection and multiple lifecycle hooks', () => {\n    element = {\n      children: [],\n      directives: [\n        {\n          isComponent: false,\n          isElement: false,\n          name: 'NgForOf',\n          lifecycle: {ngDoCheck: 5, ngAfterViewInit: 100},\n          changeDetection: 10,\n        },\n      ],\n    };\n    expect(formatter.getValue(element)).toBe(115);\n  });\n});\n\ndescribe('getLabel cases', () => {\n  let element: ElementProfile;\n\n  it('has only components', () => {\n    element = {\n      children: [],\n      directives: [\n        {\n          changeDetection: 10,\n          isElement: false,\n          isComponent: true,\n          lifecycle: {},\n          outputs: {},\n          name: 'AppComponent',\n        },\n      ],\n      type: 'element',\n    };\n    expect(formatter.getLabel(element)).toBe('AppComponent');\n  });\n\n  it('has only directives', () => {\n    element = {\n      children: [],\n      directives: [\n        {\n          isComponent: false,\n          isElement: false,\n          name: 'RouterOutlet',\n          lifecycle: {},\n          outputs: {},\n          changeDetection: 0,\n        },\n      ],\n      type: 'element',\n    };\n    expect(formatter.getLabel(element)).toBe('[RouterOutlet]');\n  });\n\n  it('has a component and a directive', () => {\n    element = {\n      children: [],\n      directives: [\n        {\n          isComponent: false,\n          isElement: false,\n          name: 'TooltipDirective',\n          lifecycle: {},\n          outputs: {},\n          changeDetection: 0,\n        },\n        {\n          changeDetection: 0,\n          isElement: false,\n          isComponent: true,\n          lifecycle: {},\n          outputs: {},\n          name: 'TodoComponent',\n        },\n      ],\n      type: 'element',\n    };\n    expect(formatter.getLabel(element)).toBe('TodoComponent[TooltipDirective]');\n  });\n\n  it('has a component and multiple directives', () => {\n    element = {\n      children: [],\n      directives: [\n        {\n          isComponent: false,\n          isElement: false,\n          name: 'TooltipDirective',\n          lifecycle: {},\n          outputs: {},\n          changeDetection: 0,\n        },\n        {\n          isComponent: false,\n          isElement: false,\n          name: 'RandomDirective',\n          lifecycle: {},\n          outputs: {},\n          changeDetection: 0,\n        },\n        {\n          changeDetection: 0,\n          isElement: false,\n          isComponent: true,\n          lifecycle: {},\n          outputs: {},\n          name: 'TodoComponent',\n        },\n      ],\n      type: 'element',\n    };\n    expect(formatter.getLabel(element)).toBe('TodoComponent[TooltipDirective, RandomDirective]');\n  });\n});\n\ndescribe('getDirectiveValue cases', () => {\n  let directive!: DirectiveProfile;\n\n  it('calculates value with  no lifecycle hooks', () => {\n    directive = {\n      changeDetection: 10,\n      isElement: false,\n      isComponent: true,\n      lifecycle: {},\n      name: 'AppComponent',\n      outputs: {},\n    };\n    expect(formatter.getDirectiveValue(directive)).toBe(10);\n  });\n\n  it('calculates value with 0 change detection and existing lifecycle hooks', () => {\n    directive = {\n      isComponent: false,\n      isElement: false,\n      name: 'NgForOf',\n      lifecycle: {ngDoCheck: 5},\n      changeDetection: 0,\n      outputs: {},\n    };\n    expect(formatter.getDirectiveValue(directive)).toBe(5);\n  });\n\n  it('calculates value with non 0 change detection and one lifecycle hook', () => {\n    directive = {\n      isComponent: false,\n      isElement: false,\n      name: 'NgForOf',\n      lifecycle: {ngDoCheck: 5},\n      changeDetection: 10,\n      outputs: {},\n    };\n    expect(formatter.getDirectiveValue(directive)).toBe(15);\n  });\n\n  it('calculates value with non 0 change detection and multiple lifecycle hooks', () => {\n    directive = {\n      isComponent: false,\n      isElement: false,\n      name: 'NgForOf',\n      lifecycle: {ngDoCheck: 5, ngAfterViewInit: 100},\n      changeDetection: 10,\n      outputs: {},\n    };\n    expect(formatter.getDirectiveValue(directive)).toBe(115);\n  });\n});\n"]}