{"version":3,"file":"frame-selector.component.js","sourceRoot":"","sources":["frame-selector.component.ts"],"names":[],"mappings":"AAAA;;;;;;GAMG;;AAEH,OAAO,EACL,wBAAwB,EACxB,yBAAyB,EACzB,eAAe,GAChB,MAAM,wBAAwB,CAAC;AAChC,OAAO,EACL,iBAAiB,EACjB,uBAAuB,EACvB,SAAS,EACT,QAAQ,EAER,MAAM,EACN,KAAK,EACL,YAAY,EACZ,MAAM,EAEN,MAAM,EACN,SAAS,GACV,MAAM,eAAe,CAAC;AAEvB,OAAO,EAAC,SAAS,EAAC,MAAM,2BAA2B,CAAC;AAGpD,OAAO,EAAC,OAAO,EAAC,MAAM,wBAAwB,CAAC;AAC/C,OAAO,EAAC,UAAU,EAAC,MAAM,2BAA2B,CAAC;AACrD,OAAO,EAAC,WAAW,EAAE,OAAO,EAAC,MAAM,iBAAiB,CAAC;AAErD,OAAO,EAAC,eAAe,EAAC,MAAM,4CAA4C,CAAC;AAC3E,OAAO,EAAC,iBAAiB,EAAC,MAAM,+BAA+B,CAAC;AAEhE,MAAM,QAAQ,GAAG,GAAG,CAAC;AACrB,MAAM,UAAU,GAAG,EAAE,CAAC;AACtB,MAAM,UAAU,GAAG,GAAG,CAAC;AACvB,MAAM,iBAAiB,GAAG,CAAC,CAAC;AAE5B,4DAA4D;AAC5D,SAAS,iBAAiB,CAAI,MAA+B,EAAE,YAAe;IAC5E,OAAO,YAAY,CAAqB;QACtC,MAAM;QACN,WAAW,EAAE,CAAC,MAAM,EAAE,IAAI,EAAE,EAAE;YAC5B,IAAI,MAAM,CAAC,MAAM,KAAK,IAAI,EAAE,MAAM,CAAC,MAAM,EAAE,CAAC;gBAC1C,OAAO,YAAY,CAAC;YACtB,CAAC;YACD,OAAO,IAAI,CAAC,KAAK,CAAC;QACpB,CAAC;KACF,CAAC,CAAC;AACL,CAAC;AAqBM,IAAM,sBAAsB,GAA5B,MAAM,sBAAsB;IA8CjC;QA7CiB,cAAS,GAAG,MAAM,CAAC,SAAS,CAAC,CAAC;QAEtC,iBAAY,GAAG,SAAS,CAAC,QAAQ,CAAa,cAAc,CAAC,CAAC;QAC9D,WAAM,GAAG,KAAK,CAAkB,EAAE,CAAC,CAAC;QAEpC,iBAAY,GAAG,MAAM,EAAuB,CAAC;QAE7C,aAAQ,GAAG,SAAS,CAAC,QAAQ,CAA2B,wBAAwB,CAAC,CAAC;QAElF,oBAAe,GAAG,iBAAiB,CAAS,IAAI,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC,CAAC;QAC7D,kBAAa,GAAG,iBAAiB,CAAS,IAAI,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC,CAAC;QAC3D,yBAAoB,GAAG,iBAAiB,CAAc,IAAI,CAAC,MAAM,EAAE,IAAI,GAAG,EAAE,CAAC,CAAC;QAE9E,kBAAa,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC;QAC9B,eAAU,GAAG,QAAQ,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,MAAM,CAAC,CAAC;QAClD,2BAAsB,GAAG,QAAQ,CACxC,GAAG,EAAE,CAAC,IAAI,CAAC,aAAa,EAAE,IAAI,IAAI,CAAC,UAAU,EAAE,GAAG,CAAC,IAAI,IAAI,CAAC,oBAAoB,EAAE,CAAC,IAAI,GAAG,CAAC,CAC5F,CAAC;QACO,+BAA0B,GAAG,QAAQ,CAC5C,GAAG,EAAE,CAAC,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,IAAI,IAAI,CAAC,oBAAoB,EAAE,CAAC,IAAI,GAAG,CAAC,CAC1E,CAAC;QACO,mBAAc,GAAG,QAAQ,CAAC,GAAG,EAAE;YACtC,IAAI,IAAI,CAAC,eAAe,EAAE,KAAK,IAAI,CAAC,aAAa,EAAE,EAAE,CAAC;gBACpD,OAAO,GAAG,IAAI,CAAC,eAAe,EAAE,GAAG,CAAC,EAAE,CAAC;YACzC,CAAC;YAED,OAAO,IAAI,CAAC,qBAAqB,CAAC,CAAC,GAAG,IAAI,CAAC,oBAAoB,EAAE,CAAC,CAAC,CAAC;QACtE,CAAC,CAAC,CAAC;QAEK,yBAAoB,GAAG,EAAC,UAAU,EAAE,CAAC,EAAE,WAAW,EAAE,CAAC,EAAE,eAAe,EAAE,KAAK,EAAC,CAAC;QAE9E,cAAS,GAAG,UAAU,GAAG,QAAQ,CAAC;QAE1B,qBAAgB,GAAG,QAAQ,CAAC,GAAG,EAAE,CAChD,IAAI,CAAC,MAAM,EAAE,CAAC,MAAM,CAAC,CAAC,GAAW,EAAE,KAAoB,EAAE,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,EAAE,KAAK,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,CAC9F,CAAC;QAEe,yBAAoB,GAAG,QAAQ,CAAC,GAAG,EAAE,CACpD,UAAU,CAAC,CAAC,UAAU,GAAG,IAAI,CAAC,gBAAgB,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAC9D,CAAC;QAEiB,cAAS,GAAG,QAAQ,CAAc,GAAG,EAAE,CACxD,IAAI,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,EAAE,IAAI,CAAC,oBAAoB,EAAE,CAAC,CAAC,CAC5E,CAAC;QAGA,iBAAiB,CAAC,GAAG,EAAE;YACrB,iEAAiE;YACjE,oEAAoE;YACpE,IAAI,CAAC,SAAS,CAAC,SAAS,EAAE,CAAC;YAE3B,MAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;YACjC,QAAQ,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC;YAC1B,QAAQ,CAAC,iBAAiB,EAAE,CAAC;QAC/B,CAAC,CAAC,CAAC;QACH,iBAAiB,CAAC,GAAG,EAAE;YACrB,MAAM,KAAK,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC;YAC5B,IAAI,CAAC,QAAQ,EAAE,CAAC,aAAa,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;QAC9C,CAAC,CAAC,CAAC;IACL,CAAC;IAEO,qBAAqB,CAAC,UAAoB;QAChD,MAAM,aAAa,GAAG,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;QAEvD,MAAM,MAAM,GAAe,EAAE,CAAC;QAC9B,IAAI,IAAI,GAAkB,IAAI,CAAC;QAE/B,KAAK,MAAM,KAAK,IAAI,aAAa,EAAE,CAAC;YAClC,iFAAiF;YACjF,IAAI,IAAI,KAAK,IAAI,EAAE,CAAC;gBAClB,MAAM,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;gBACrB,IAAI,GAAG,KAAK,CAAC;gBACb,SAAS;YACX,CAAC;YAED,6FAA6F;YAC7F,IAAI,IAAI,GAAG,CAAC,KAAK,KAAK,EAAE,CAAC;gBACvB,MAAM,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YACxC,CAAC;iBAAM,CAAC;gBACN,MAAM,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;YACvB,CAAC;YAED,IAAI,GAAG,KAAK,CAAC;QACf,CAAC;QAED,OAAO,MAAM;aACV,MAAM,CAAC,CAAC,KAAK,EAAE,EAAE,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC;aACnC,GAAG,CAAC,CAAC,KAAK,EAAE,EAAE,CACb,KAAK,CAAC,MAAM,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,GAAG,CAAC,EAAE,CACrF;aACA,IAAI,CAAC,IAAI,CAAC,CAAC;IAChB,CAAC;IAED,IAAI,CAAC,KAAa;QAChB,MAAM,MAAM,GAAG,IAAI,CAAC,eAAe,EAAE,GAAG,KAAK,CAAC;QAC9C,IAAI,CAAC,oBAAoB,CAAC,GAAG,CAAC,IAAI,GAAG,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;QACjD,IAAI,MAAM,GAAG,CAAC,CAAC,IAAI,MAAM,GAAG,IAAI,CAAC,UAAU,EAAE,EAAE,CAAC;YAC9C,IAAI,CAAC,aAAa,CAAC,EAAC,OAAO,EAAE,IAAI,CAAC,oBAAoB,EAAE,EAAC,CAAC,CAAC;QAC7D,CAAC;IACH,CAAC;IAEO,aAAa,CAAC,EAAC,OAAO,EAAyB;QACrD,MAAM,aAAa,GAAG,CAAC,GAAG,OAAO,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;QACzD,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC;QAC3C,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,aAAa,CAAC,aAAa,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;QAChE,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,eAAe,EAAE,CAAC,CAAC;QAC5C,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,EAAC,OAAO,EAAE,aAAa,EAAC,CAAC,CAAC;IACnD,CAAC;IAED,oBAAoB,CAAC,GAAW,EAAE,KAAiB;QACjD,MAAM,EAAC,QAAQ,EAAE,OAAO,EAAE,OAAO,EAAC,GAAG,KAAK,CAAC;QAC3C,IAAI,MAAM,GAAG,IAAI,CAAC,oBAAoB,EAAE,CAAC;QACzC,IAAI,QAAQ,EAAE,CAAC;YACb,MAAM,CAAC,KAAK,EAAE,GAAG,CAAC,GAAG;gBACnB,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,eAAe,EAAE,EAAE,GAAG,CAAC;gBACrC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,aAAa,EAAE,EAAE,GAAG,CAAC;aACpC,CAAC;YACF,MAAM,GAAG,IAAI,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,GAAG,KAAK,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,KAAK,EAAE,EAAE,CAAC,KAAK,GAAG,KAAK,CAAC,CAAC,CAAC;QACpF,CAAC;aAAM,IAAI,OAAO,IAAI,OAAO,EAAE,CAAC;YAC9B,IAAI,MAAM,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC;gBACpB,IAAI,MAAM,CAAC,IAAI,KAAK,CAAC,EAAE,CAAC;oBACtB,OAAO,CAAC,sDAAsD;gBAChE,CAAC;gBAED,MAAM,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;YACrB,CAAC;iBAAM,CAAC;gBACN,MAAM,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;YAClB,CAAC;QACH,CAAC;aAAM,CAAC;YACN,MAAM,GAAG,IAAI,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;QAC1B,CAAC;QACD,IAAI,CAAC,oBAAoB,CAAC,GAAG,CAAC,IAAI,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC;QAC/C,IAAI,CAAC,aAAa,CAAC,EAAC,OAAO,EAAE,IAAI,CAAC,oBAAoB,EAAE,EAAC,CAAC,CAAC;IAC7D,CAAC;IAEO,cAAc,CAAC,KAAa;QAClC,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,EAAE,CAAC;YACrB,OAAO;QACT,CAAC;QACD,MAAM,YAAY,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC,UAAU,CAAC,aAAa,CAAC;QAC9D,wCAAwC;QACxC,MAAM,IAAI,GAAG,YAAY,CAAC,UAAU,CAAC;QACrC,2DAA2D;QAC3D,MAAM,KAAK,GAAG,IAAI,GAAG,YAAY,CAAC,WAAW,CAAC;QAC9C,MAAM,QAAQ,GAAG,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC;QACxC,IAAI,QAAQ,GAAG,IAAI,EAAE,CAAC;YACpB,YAAY,CAAC,QAAQ,CAAC,EAAC,IAAI,EAAE,QAAQ,EAAC,CAAC,CAAC;QAC1C,CAAC;aAAM,IAAI,KAAK,GAAG,QAAQ,GAAG,IAAI,CAAC,SAAS,EAAE,CAAC;YAC7C,YAAY,CAAC,QAAQ,CAAC,EAAC,IAAI,EAAE,QAAQ,GAAG,YAAY,CAAC,WAAW,GAAG,IAAI,CAAC,SAAS,EAAC,CAAC,CAAC;QACtF,CAAC;IACH,CAAC;IAED,iBAAiB;QACf,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;QAC9B,IAAI,CAAC,oBAAoB,CAAC,eAAe,GAAG,KAAK,CAAC;IACpD,CAAC;IAED,eAAe,CAAC,KAAiB;QAC/B,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;QAC7B,IAAI,CAAC,oBAAoB,GAAG;YAC1B,WAAW,EAAE,KAAK,CAAC,OAAO;YAC1B,UAAU,EAAE,IAAI,CAAC,QAAQ,EAAE,CAAC,UAAU,CAAC,aAAa,CAAC,UAAU;YAC/D,eAAe,EAAE,IAAI;SACtB,CAAC;IACJ,CAAC;IAED,UAAU,CAAC,KAAiB;QAC1B,IAAI,CAAC,IAAI,CAAC,oBAAoB,CAAC,eAAe,EAAE,CAAC;YAC/C,OAAO;QACT,CAAC;QAED,MAAM,EAAE,GAAG,KAAK,CAAC,OAAO,GAAG,IAAI,CAAC,oBAAoB,CAAC,WAAW,CAAC;QACjE,IAAI,CAAC,QAAQ,EAAE,CAAC,UAAU,CAAC,aAAa,CAAC,UAAU;YACjD,IAAI,CAAC,oBAAoB,CAAC,UAAU,GAAG,EAAE,GAAG,iBAAiB,CAAC;IAClE,CAAC;IAED,YAAY,CAAC,KAAa;QACxB,OAAO,KAAK,CAAC;IACf,CAAC;IAEO,YAAY,CAAC,KAAoB,EAAE,oBAA4B;QACrE,MAAM,MAAM,GAAG,KAAK,CAAC,QAAQ,GAAG,oBAAoB,CAAC;QACrD,MAAM,eAAe,GAAG,IAAI,CAAC,GAAG,CAAC,EAAE,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,MAAM,GAAG,UAAU,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC;QAC9E,MAAM,eAAe,GAAG,IAAI,CAAC,mBAAmB,CAAC,iBAAiB,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC;QAEpF,MAAM,KAAK,GAAG;YACZ,kBAAkB,EAAE,mCAAmC,eAAe,IAAI,eAAe,kBAAkB,eAAe,IAAI;YAC9H,KAAK,EAAE,UAAU,GAAG,IAAI;YACxB,MAAM,EAAE,UAAU,GAAG,IAAI;SAC1B,CAAC;QACF,MAAM,OAAO,GAAG,GAAG,KAAK,CAAC,MAAM,eAAe,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI,CAAC;QAC5E,OAAO,EAAC,KAAK,EAAE,OAAO,EAAE,KAAK,EAAC,CAAC;IACjC,CAAC;IAEO,mBAAmB,CAAC,SAAiB;QAC3C,IAAI,SAAS,IAAI,EAAE,EAAE,CAAC;YACpB,OAAO,yBAAyB,CAAC;QACnC,CAAC;aAAM,IAAI,EAAE,GAAG,SAAS,IAAI,SAAS,IAAI,EAAE,EAAE,CAAC;YAC7C,OAAO,0BAA0B,CAAC;QACpC,CAAC;aAAM,IAAI,EAAE,GAAG,SAAS,IAAI,SAAS,IAAI,EAAE,EAAE,CAAC;YAC7C,OAAO,uBAAuB,CAAC;QACjC,CAAC;QACD,OAAO,uBAAuB,CAAC;IACjC,CAAC;CACF,CAAA;AA7MY,sBAAsB;IAnBlC,SAAS,CAAC;QACT,QAAQ,EAAE,mBAAmB;QAC7B,WAAW,EAAE,iCAAiC;QAC9C,SAAS,EAAE,CAAC,iCAAiC,CAAC;QAC9C,MAAM,EAAE;gCACsB,UAAU;GACvC;QACD,OAAO,EAAE;YACP,UAAU;YACV,OAAO;YACP,wBAAwB;YACxB,yBAAyB;YACzB,eAAe;YACf,OAAO;YACP,eAAe;YACf,WAAW;SACZ;QACD,eAAe,EAAE,uBAAuB,CAAC,MAAM;KAChD,CAAC;GACW,sBAAsB,CA6MlC","sourcesContent":["/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {\n  CdkVirtualScrollViewport,\n  CdkFixedSizeVirtualScroll,\n  CdkVirtualForOf,\n} from '@angular/cdk/scrolling';\nimport {\n  afterRenderEffect,\n  ChangeDetectionStrategy,\n  Component,\n  computed,\n  ElementRef,\n  inject,\n  input,\n  linkedSignal,\n  output,\n  Signal,\n  signal,\n  viewChild,\n} from '@angular/core';\n\nimport {TabUpdate} from '../../../tab-update/index';\n\nimport {GraphNode} from '../record-formatter/record-formatter';\nimport {MatIcon} from '@angular/material/icon';\nimport {MatTooltip} from '@angular/material/tooltip';\nimport {DecimalPipe, NgStyle} from '@angular/common';\nimport {ProfilerFrame} from '../../../../../../../protocol';\nimport {ButtonComponent} from '../../../../shared/button/button.component';\nimport {estimateFrameRate} from '../shared/estimate-frame-rate';\n\nconst ITEM_GAP = 2.5;\nconst ITEM_WIDTH = 18;\nconst MAX_HEIGHT = 100;\nconst DRAG_SCROLL_SPEED = 2;\n\n/** Returns a linked signal that resets on source change. */\nfunction framesBoundSignal<T>(source: Signal<ProfilerFrame[]>, defaultValue: T) {\n  return linkedSignal<ProfilerFrame[], T>({\n    source,\n    computation: (source, prev) => {\n      if (source.length !== prev?.source.length) {\n        return defaultValue;\n      }\n      return prev.value;\n    },\n  });\n}\n\n@Component({\n  selector: 'ng-frame-selector',\n  templateUrl: './frame-selector.component.html',\n  styleUrls: ['./frame-selector.component.scss'],\n  styles: `\n    :host { --max-bar-height: ${MAX_HEIGHT}px }\n  `,\n  imports: [\n    MatTooltip,\n    MatIcon,\n    CdkVirtualScrollViewport,\n    CdkFixedSizeVirtualScroll,\n    CdkVirtualForOf,\n    NgStyle,\n    ButtonComponent,\n    DecimalPipe,\n  ],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class FrameSelectorComponent {\n  private readonly tabUpdate = inject(TabUpdate);\n\n  readonly barContainer = viewChild.required<ElementRef>('barContainer');\n  readonly frames = input<ProfilerFrame[]>([]);\n\n  readonly selectFrames = output<{indexes: number[]}>();\n\n  readonly viewport = viewChild.required<CdkVirtualScrollViewport>(CdkVirtualScrollViewport);\n\n  readonly startFrameIndex = framesBoundSignal<number>(this.frames, -1);\n  readonly endFrameIndex = framesBoundSignal<number>(this.frames, -1);\n  readonly selectedFrameIndexes = framesBoundSignal<Set<number>>(this.frames, new Set());\n\n  readonly dragScrolling = signal(false);\n  readonly frameCount = computed(() => this.frames().length);\n  readonly disableNextFrameButton = computed(\n    () => this.endFrameIndex() >= this.frameCount() - 1 || this.selectedFrameIndexes().size > 1,\n  );\n  readonly disablePreviousFrameButton = computed(\n    () => this.startFrameIndex() <= 0 || this.selectedFrameIndexes().size > 1,\n  );\n  readonly selectionLabel = computed(() => {\n    if (this.startFrameIndex() === this.endFrameIndex()) {\n      return `${this.startFrameIndex() + 1}`;\n    }\n\n    return this._smartJoinIndexLabels([...this.selectedFrameIndexes()]);\n  });\n\n  private _viewportScrollState = {scrollLeft: 0, xCoordinate: 0, isDragScrolling: false};\n\n  readonly itemWidth = ITEM_WIDTH + ITEM_GAP;\n\n  private readonly maxFrameDuration = computed(() =>\n    this.frames().reduce((acc: number, frame: ProfilerFrame) => Math.max(acc, frame.duration), 0),\n  );\n\n  private readonly multiplicationFactor = computed(() =>\n    parseFloat((MAX_HEIGHT / this.maxFrameDuration()).toFixed(2)),\n  );\n\n  protected readonly graphData = computed<GraphNode[]>(() =>\n    this.frames().map((r) => this.getBarStyles(r, this.multiplicationFactor())),\n  );\n\n  constructor() {\n    afterRenderEffect(() => {\n      // Listen for tab updates to reset the scroll position to the top\n      // This ensures the viewport is properly updated when switching tabs\n      this.tabUpdate.tabUpdate();\n\n      const viewport = this.viewport();\n      viewport.scrollToIndex(0);\n      viewport.checkViewportSize();\n    });\n    afterRenderEffect(() => {\n      const items = this.frames();\n      this.viewport().scrollToIndex(items.length);\n    });\n  }\n\n  private _smartJoinIndexLabels(indexArray: number[]): string {\n    const sortedIndexes = indexArray.sort((a, b) => a - b);\n\n    const groups: number[][] = [];\n    let prev: number | null = null;\n\n    for (const index of sortedIndexes) {\n      // First iteration: create initial group and set prev variable to the first index\n      if (prev === null) {\n        groups.push([index]);\n        prev = index;\n        continue;\n      }\n\n      // If current index is consecutive with the previous, group them, otherwise start a new group\n      if (prev + 1 === index) {\n        groups[groups.length - 1].push(index);\n      } else {\n        groups.push([index]);\n      }\n\n      prev = index;\n    }\n\n    return groups\n      .filter((group) => group.length > 0)\n      .map((group) =>\n        group.length === 1 ? group[0] + 1 : `${group[0] + 1}-${group[group.length - 1] + 1}`,\n      )\n      .join(', ');\n  }\n\n  move(value: number): void {\n    const newVal = this.startFrameIndex() + value;\n    this.selectedFrameIndexes.set(new Set([newVal]));\n    if (newVal > -1 && newVal < this.frameCount()) {\n      this._selectFrames({indexes: this.selectedFrameIndexes()});\n    }\n  }\n\n  private _selectFrames({indexes}: {indexes: Set<number>}): void {\n    const sortedIndexes = [...indexes].sort((a, b) => a - b);\n    this.startFrameIndex.set(sortedIndexes[0]);\n    this.endFrameIndex.set(sortedIndexes[sortedIndexes.length - 1]);\n    this._ensureVisible(this.startFrameIndex());\n    this.selectFrames.emit({indexes: sortedIndexes});\n  }\n\n  handleFrameSelection(idx: number, event: MouseEvent): void {\n    const {shiftKey, ctrlKey, metaKey} = event;\n    let frames = this.selectedFrameIndexes();\n    if (shiftKey) {\n      const [start, end] = [\n        Math.min(this.startFrameIndex(), idx),\n        Math.max(this.endFrameIndex(), idx),\n      ];\n      frames = new Set(Array.from(Array(end - start + 1), (_, index) => index + start));\n    } else if (ctrlKey || metaKey) {\n      if (frames.has(idx)) {\n        if (frames.size === 1) {\n          return; // prevent deselection when only one frame is selected\n        }\n\n        frames.delete(idx);\n      } else {\n        frames.add(idx);\n      }\n    } else {\n      frames = new Set([idx]);\n    }\n    this.selectedFrameIndexes.set(new Set(frames));\n    this._selectFrames({indexes: this.selectedFrameIndexes()});\n  }\n\n  private _ensureVisible(index: number): void {\n    if (!this.viewport()) {\n      return;\n    }\n    const scrollParent = this.viewport().elementRef.nativeElement;\n    // The left most point we see an element\n    const left = scrollParent.scrollLeft;\n    // That's the right most point we currently see an element.\n    const right = left + scrollParent.offsetWidth;\n    const itemLeft = index * this.itemWidth;\n    if (itemLeft < left) {\n      scrollParent.scrollTo({left: itemLeft});\n    } else if (right < itemLeft + this.itemWidth) {\n      scrollParent.scrollTo({left: itemLeft - scrollParent.offsetWidth + this.itemWidth});\n    }\n  }\n\n  stopDragScrolling(): void {\n    this.dragScrolling.set(false);\n    this._viewportScrollState.isDragScrolling = false;\n  }\n\n  startDragScroll(event: MouseEvent): void {\n    this.dragScrolling.set(true);\n    this._viewportScrollState = {\n      xCoordinate: event.clientX,\n      scrollLeft: this.viewport().elementRef.nativeElement.scrollLeft,\n      isDragScrolling: true,\n    };\n  }\n\n  dragScroll(event: MouseEvent): void {\n    if (!this._viewportScrollState.isDragScrolling) {\n      return;\n    }\n\n    const dx = event.clientX - this._viewportScrollState.xCoordinate;\n    this.viewport().elementRef.nativeElement.scrollLeft =\n      this._viewportScrollState.scrollLeft - dx * DRAG_SCROLL_SPEED;\n  }\n\n  trackByIndex(index: number): number {\n    return index;\n  }\n\n  private getBarStyles(frame: ProfilerFrame, multiplicationFactor: number): GraphNode {\n    const height = frame.duration * multiplicationFactor;\n    const colorPercentage = Math.max(10, Math.round((height / MAX_HEIGHT) * 100));\n    const backgroundColor = this.getColorByFrameRate(estimateFrameRate(frame.duration));\n\n    const style = {\n      'background-image': `-webkit-linear-gradient(bottom, ${backgroundColor} ${colorPercentage}%, transparent ${colorPercentage}%)`,\n      width: ITEM_WIDTH + 'px',\n      height: MAX_HEIGHT + 'px',\n    };\n    const toolTip = `${frame.source} TimeSpent: ${frame.duration.toFixed(3)}ms`;\n    return {style, toolTip, frame};\n  }\n\n  private getColorByFrameRate(framerate: number): string {\n    if (framerate >= 60) {\n      return 'var(--dynamic-green-01)';\n    } else if (60 > framerate && framerate >= 30) {\n      return 'var(--dynamic-yellow-01)';\n    } else if (30 > framerate && framerate >= 15) {\n      return 'var(--dynamic-red-03)';\n    }\n    return 'var(--dynamic-red-01)';\n  }\n}\n"]}