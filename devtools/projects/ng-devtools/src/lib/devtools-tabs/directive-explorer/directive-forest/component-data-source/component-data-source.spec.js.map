{"version":3,"file":"component-data-source.spec.js","sourceRoot":"","sources":["component-data-source.spec.ts"],"names":[],"mappings":"AAAA;;;;;;GAMG;AAEH,OAAO,EAAC,eAAe,EAAC,MAAM,mBAAmB,CAAC;AAGlD,OAAO,EAAC,mBAAmB,EAAW,MAAM,GAAG,CAAC;AAEhD,MAAM,KAAK,GAAiB;IAC1B,OAAO,EAAE,KAAK;IACd,UAAU,EAAE;QACV;YACE,EAAE,EAAE,CAAC;YACL,IAAI,EAAE,KAAK;SACZ;KACF;IACD,SAAS,EAAE,IAAI;IACf,SAAS,EAAE,IAAI;IACf,QAAQ,EAAE;QACR;YACE,QAAQ,EAAE,EAAE;YACZ,SAAS,EAAE;gBACT,EAAE,EAAE,CAAC;gBACL,SAAS,EAAE,KAAK;gBAChB,IAAI,EAAE,KAAK;aACZ;YACD,UAAU,EAAE,EAAE;YACd,OAAO,EAAE,KAAK;YACd,SAAS,EAAE,IAAI;YACf,aAAa,EAAE,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;YAC5C,KAAK,EAAE,IAAI;SACZ;KACF;IACD,aAAa,EAAE,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;IAC5C,KAAK,EAAE,IAAI;CACZ,CAAC;AAEF,MAAM,KAAK,GAAiB;IAC1B,OAAO,EAAE,KAAK;IACd,UAAU,EAAE;QACV;YACE,EAAE,EAAE,CAAC;YACL,IAAI,EAAE,KAAK;SACZ;KACF;IACD,SAAS,EAAE,IAAI;IACf,SAAS,EAAE,IAAI;IACf,QAAQ,EAAE;QACR;YACE,QAAQ,EAAE,EAAE;YACZ,SAAS,EAAE;gBACT,EAAE,EAAE,CAAC;gBACL,SAAS,EAAE,KAAK;gBAChB,IAAI,EAAE,KAAK;aACZ;YACD,UAAU,EAAE,EAAE;YACd,OAAO,EAAE,KAAK;YACd,SAAS,EAAE,IAAI;YACf,aAAa,EAAE,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;YAC5C,KAAK,EAAE,IAAI;SACZ;QACD;YACE,QAAQ,EAAE,EAAE;YACZ,SAAS,EAAE;gBACT,EAAE,EAAE,CAAC;gBACL,SAAS,EAAE,KAAK;gBAChB,IAAI,EAAE,KAAK;aACZ;YACD,UAAU,EAAE,EAAE;YACd,OAAO,EAAE,KAAK;YACd,SAAS,EAAE,IAAI;YACf,aAAa,EAAE,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;YAC5C,KAAK,EAAE,IAAI;SACZ;KACF;IACD,aAAa,EAAE,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;IAC5C,KAAK,EAAE,IAAI;CACZ,CAAC;AAEF,MAAM,KAAK,GAAiB;IAC1B,OAAO,EAAE,KAAK;IACd,UAAU,EAAE;QACV;YACE,EAAE,EAAE,CAAC;YACL,IAAI,EAAE,KAAK;SACZ;KACF;IACD,SAAS,EAAE,IAAI;IACf,SAAS,EAAE,IAAI;IACf,QAAQ,EAAE;QACR;YACE,QAAQ,EAAE,EAAE;YACZ,SAAS,EAAE;gBACT,EAAE,EAAE,CAAC;gBACL,SAAS,EAAE,KAAK;gBAChB,IAAI,EAAE,KAAK;aACZ;YACD,UAAU,EAAE,EAAE;YACd,OAAO,EAAE,UAAU;YACnB,SAAS,EAAE,IAAI;YACf,KAAK,EAAE,IAAI;YACX,aAAa,EAAE,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;SAC7C;QACD;YACE,QAAQ,EAAE,EAAE;YACZ,SAAS,EAAE;gBACT,EAAE,EAAE,CAAC;gBACL,SAAS,EAAE,KAAK;gBAChB,IAAI,EAAE,KAAK;aACZ;YACD,UAAU,EAAE,EAAE;YACd,OAAO,EAAE,UAAU;YACnB,SAAS,EAAE,IAAI;YACf,KAAK,EAAE,IAAI;YACX,aAAa,EAAE,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;SAC7C;KACF;IACD,aAAa,EAAE,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;IAC5C,KAAK,EAAE,IAAI;CACZ,CAAC;AAEF,MAAM,KAAK,GAAiB;IAC1B,OAAO,EAAE,KAAK;IACd,SAAS,EAAE,IAAI;IACf,UAAU,EAAE;QACV;YACE,EAAE,EAAE,CAAC;YACL,IAAI,EAAE,KAAK;SACZ;KACF;IACD,SAAS,EAAE,IAAI;IACf,QAAQ,EAAE;QACR;YACE,QAAQ,EAAE;gBACR;oBACE,QAAQ,EAAE;wBACR;4BACE,QAAQ,EAAE;gCACR;oCACE,QAAQ,EAAE;wCACR;4CACE,QAAQ,EAAE,EAAE;4CACZ,SAAS,EAAE;gDACT,EAAE,EAAE,CAAC;gDACL,SAAS,EAAE,KAAK;gDAChB,IAAI,EAAE,KAAK;6CACZ;4CACD,UAAU,EAAE,EAAE;4CACd,OAAO,EAAE,KAAK;4CACd,SAAS,EAAE,IAAI;4CACf,KAAK,EAAE,IAAI;4CACX,aAAa,EAAE,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;yCAC7C;qCACF;oCACD,SAAS,EAAE;wCACT,EAAE,EAAE,CAAC;wCACL,SAAS,EAAE,KAAK;wCAChB,IAAI,EAAE,KAAK;qCACZ;oCACD,UAAU,EAAE,EAAE;oCACd,OAAO,EAAE,UAAU;oCACnB,SAAS,EAAE,IAAI;oCACf,KAAK,EAAE,IAAI;oCACX,aAAa,EAAE,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;iCAC7C;6BACF;4BACD,SAAS,EAAE;gCACT,EAAE,EAAE,CAAC;gCACL,SAAS,EAAE,KAAK;gCAChB,IAAI,EAAE,KAAK;6BACZ;4BACD,UAAU,EAAE,EAAE;4BACd,OAAO,EAAE,UAAU;4BACnB,SAAS,EAAE,IAAI;4BACf,KAAK,EAAE,IAAI;4BACX,aAAa,EAAE,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;yBAC7C;qBACF;oBACD,SAAS,EAAE;wBACT,EAAE,EAAE,CAAC;wBACL,SAAS,EAAE,KAAK;wBAChB,IAAI,EAAE,KAAK;qBACZ;oBACD,UAAU,EAAE,EAAE;oBACd,OAAO,EAAE,UAAU;oBACnB,SAAS,EAAE,IAAI;oBACf,KAAK,EAAE,IAAI;oBACX,aAAa,EAAE,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;iBAC7C;aACF;YACD,SAAS,EAAE;gBACT,EAAE,EAAE,CAAC;gBACL,SAAS,EAAE,KAAK;gBAChB,IAAI,EAAE,KAAK;aACZ;YACD,UAAU,EAAE,EAAE;YACd,OAAO,EAAE,UAAU;YACnB,SAAS,EAAE,IAAI;YACf,aAAa,EAAE,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;YAC5C,KAAK,EAAE,IAAI;SACZ;KACF;IACD,KAAK,EAAE,IAAI;IACX,aAAa,EAAE,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC;CAC7C,CAAC;AAEF,QAAQ,CAAC,qBAAqB,EAAE,GAAG,EAAE;IACnC,IAAI,UAA+B,CAAC;IACpC,MAAM,WAAW,GAAG,IAAI,eAAe,CACrC,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,KAAK,EACpB,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,UAAU,CAC1B,CAAC;IAEF,UAAU,CAAC,GAAG,EAAE,CAAC,CAAC,UAAU,GAAG,IAAI,mBAAmB,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;IAEtE,EAAE,CAAC,iCAAiC,EAAE,GAAG,EAAE;QACzC,MAAM,MAAM,GAAG,UAAU,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,EAAE,IAAI,CAAC,CAAC;QAChD,MAAM,CAAC,MAAM,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACzC,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QAEvC,MAAM,aAAa,GAAG,UAAU,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,EAAE,IAAI,CAAC,CAAC;QACvD,MAAM,CAAC,aAAa,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QAChD,MAAM,CAAC,aAAa,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QAClD,MAAM,CAAC,aAAa,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QAC9C,MAAM,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IACrD,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,oDAAoD,EAAE,GAAG,EAAE;QAC5D,MAAM,MAAM,GAAG,UAAU,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,EAAE,KAAK,CAAC,CAAC;QACjD,MAAM,CAAC,MAAM,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACzC,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACvC,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IAC9C,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,oDAAoD,EAAE,GAAG,EAAE;QAC5D,MAAM,MAAM,GAAG,UAAU,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,EAAE,KAAK,CAAC,CAAC;QACjD,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACvC,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAC5C,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAE5C,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACzC,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QAEzC,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IAClE,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {FlatTreeControl} from '@angular/cdk/tree';\nimport {DevToolsNode} from '../../../../../../../protocol';\n\nimport {ComponentDataSource, FlatNode} from '.';\n\nconst tree1: DevToolsNode = {\n  element: 'app',\n  directives: [\n    {\n      id: 1,\n      name: 'foo',\n    },\n  ],\n  component: null,\n  hydration: null,\n  children: [\n    {\n      children: [],\n      component: {\n        id: 2,\n        isElement: false,\n        name: 'bar',\n      },\n      directives: [],\n      element: 'bar',\n      hydration: null,\n      nativeElement: document.createElement('bar'),\n      defer: null,\n    },\n  ],\n  nativeElement: document.createElement('foo'),\n  defer: null,\n};\n\nconst tree2: DevToolsNode = {\n  element: 'app',\n  directives: [\n    {\n      id: 1,\n      name: 'foo',\n    },\n  ],\n  component: null,\n  hydration: null,\n  children: [\n    {\n      children: [],\n      component: {\n        id: 2,\n        isElement: false,\n        name: 'bar',\n      },\n      directives: [],\n      element: 'bar',\n      hydration: null,\n      nativeElement: document.createElement('bar'),\n      defer: null,\n    },\n    {\n      children: [],\n      component: {\n        id: 3,\n        isElement: false,\n        name: 'qux',\n      },\n      directives: [],\n      element: 'qux',\n      hydration: null,\n      nativeElement: document.createElement('qux'),\n      defer: null,\n    },\n  ],\n  nativeElement: document.createElement('foo'),\n  defer: null,\n};\n\nconst tree3: DevToolsNode = {\n  element: 'app',\n  directives: [\n    {\n      id: 1,\n      name: 'foo',\n    },\n  ],\n  component: null,\n  hydration: null,\n  children: [\n    {\n      children: [],\n      component: {\n        id: 2,\n        isElement: false,\n        name: 'bar',\n      },\n      directives: [],\n      element: '#comment',\n      hydration: null,\n      defer: null,\n      nativeElement: document.createComment('bar'),\n    },\n    {\n      children: [],\n      component: {\n        id: 3,\n        isElement: false,\n        name: 'qux',\n      },\n      directives: [],\n      element: '#comment',\n      hydration: null,\n      defer: null,\n      nativeElement: document.createComment('bar'),\n    },\n  ],\n  nativeElement: document.createElement('foo'),\n  defer: null,\n};\n\nconst tree4: DevToolsNode = {\n  element: 'app',\n  hydration: null,\n  directives: [\n    {\n      id: 1,\n      name: 'foo',\n    },\n  ],\n  component: null,\n  children: [\n    {\n      children: [\n        {\n          children: [\n            {\n              children: [\n                {\n                  children: [\n                    {\n                      children: [],\n                      component: {\n                        id: 6,\n                        isElement: false,\n                        name: 'qux',\n                      },\n                      directives: [],\n                      element: 'bar',\n                      hydration: null,\n                      defer: null,\n                      nativeElement: document.createComment('bar'),\n                    },\n                  ],\n                  component: {\n                    id: 5,\n                    isElement: false,\n                    name: 'qux',\n                  },\n                  directives: [],\n                  element: '#comment',\n                  hydration: null,\n                  defer: null,\n                  nativeElement: document.createComment('bar'),\n                },\n              ],\n              component: {\n                id: 4,\n                isElement: false,\n                name: 'qux',\n              },\n              directives: [],\n              element: '#comment',\n              hydration: null,\n              defer: null,\n              nativeElement: document.createComment('bar'),\n            },\n          ],\n          component: {\n            id: 3,\n            isElement: false,\n            name: 'qux',\n          },\n          directives: [],\n          element: '#comment',\n          hydration: null,\n          defer: null,\n          nativeElement: document.createComment('bar'),\n        },\n      ],\n      component: {\n        id: 2,\n        isElement: false,\n        name: 'bar',\n      },\n      directives: [],\n      element: '#comment',\n      hydration: null,\n      nativeElement: document.createComment('bar'),\n      defer: null,\n    },\n  ],\n  defer: null,\n  nativeElement: document.createElement('foo'),\n};\n\ndescribe('ComponentDataSource', () => {\n  let dataSource: ComponentDataSource;\n  const treeControl = new FlatTreeControl<FlatNode>(\n    (node) => node.level,\n    (node) => node.expandable,\n  );\n\n  beforeEach(() => (dataSource = new ComponentDataSource(treeControl)));\n\n  it('should return new and old items', () => {\n    const result = dataSource.update([tree1], true);\n    expect(result.movedItems.length).toBe(0);\n    expect(result.newItems.length).toBe(2);\n\n    const updatedResult = dataSource.update([tree2], true);\n    expect(updatedResult.movedItems.length).toBe(0);\n    expect(updatedResult.removedItems.length).toBe(0);\n    expect(updatedResult.newItems.length).toBe(1);\n    expect(updatedResult.newItems[0].name).toBe('qux');\n  });\n\n  it('should not return comment nodes when not requested', () => {\n    const result = dataSource.update([tree3], false);\n    expect(result.movedItems.length).toBe(0);\n    expect(result.newItems.length).toBe(1);\n    expect(result.newItems[0].name).toBe('app');\n  });\n\n  it('should not break nesting with nested comment nodes', () => {\n    const result = dataSource.update([tree4], false);\n    expect(result.newItems.length).toBe(2);\n    expect(result.newItems[0].name).toBe('app');\n    expect(result.newItems[1].name).toBe('qux');\n\n    expect(result.newItems[0].level).toBe(0);\n    expect(result.newItems[1].level).toBe(1);\n\n    expect(result.newItems[1].position).toEqual([0, 0, 0, 0, 0, 0]);\n  });\n});\n"]}