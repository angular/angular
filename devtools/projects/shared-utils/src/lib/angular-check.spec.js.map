{"version":3,"file":"angular-check.spec.js","sourceRoot":"","sources":["angular-check.spec.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.dev/license\n */\n\nimport {\n  appIsAngular,\n  appIsAngularInDevMode,\n  appIsAngularIvy,\n  appIsSupportedAngularVersion,\n  getAngularVersion,\n} from './angular-check';\n\nconst setNgVersion = (version = '12.0.0'): void =>\n  document.documentElement.setAttribute('ng-version', version);\nconst removeNgVersion = (): void => document.documentElement.removeAttribute('ng-version');\n\ndescribe('angular-check', () => {\n  afterEach(() => removeNgVersion());\n\n  describe('getAngularVersion', () => {\n    it('should return the angular version', () => {\n      setNgVersion('11.1.1');\n      expect(getAngularVersion()).toBe('11.1.1');\n    });\n  });\n\n  describe('appIsSupportedAngularVersion', () => {\n    it('should work with g3', () => {\n      setNgVersion('0.0.0-placeholder');\n      expect(appIsSupportedAngularVersion()).toBeTrue();\n    });\n\n    it('should work with new versions', () => {\n      setNgVersion('12.0.0');\n      expect(appIsSupportedAngularVersion()).toBeTrue();\n    });\n\n    it('should return false for older version', () => {\n      setNgVersion('9.0.0');\n      expect(appIsSupportedAngularVersion()).toBeFalse();\n    });\n\n    it('should return false for no version', () => {\n      expect(appIsSupportedAngularVersion()).toBeFalse();\n    });\n  });\n\n  describe('appIsAngular', () => {\n    it('should return true for older version', () => {\n      setNgVersion('8.0.0');\n      expect(appIsAngular()).toBeTrue();\n    });\n\n    it('should return false for no version', () => {\n      expect(appIsAngular()).toBeFalse();\n    });\n  });\n\n  describe('appIsAngularIvy', () => {\n    it('should not recognize VE apps', () => {\n      (window as any).ng = {\n        probe(): void {},\n      };\n      setNgVersion();\n      expect(appIsAngularIvy()).toBeFalse();\n    });\n\n    it('should not recognize no Angular apps', () => {\n      expect(appIsAngularIvy()).toBeFalse();\n    });\n\n    it('should recognize Ivy apps', () => {\n      const el = document.createElement('div');\n      el.setAttribute('ng-version', '0.0.0-PLACEHOLDER');\n      (el as any).__ngContext__ = 0;\n      document.body.append(el);\n      expect(appIsAngularIvy()).toBeTrue();\n      el.remove();\n    });\n  });\n\n  describe('appIsAngularInDevMode', () => {\n    afterEach(() => {\n      delete (window as any).ng;\n    });\n\n    it('should detect VE apps', () => {\n      (window as any).ng = {\n        probe(): void {},\n      };\n      setNgVersion();\n\n      expect(appIsAngularInDevMode()).toBeTrue();\n    });\n\n    it('should detect Ivy apps', () => {\n      (window as any).ng = {\n        getComponent(): void {},\n      };\n      setNgVersion();\n      expect(appIsAngularInDevMode()).toBeTrue();\n    });\n\n    it('should not detect apps if `ng` is not an object with the right shape', () => {\n      setNgVersion();\n      (window as any).ng = {};\n      expect(appIsAngularInDevMode()).toBeFalse();\n\n      (window as any).ng = () => {};\n      expect(appIsAngularInDevMode()).toBeFalse();\n    });\n  });\n});\n"]}