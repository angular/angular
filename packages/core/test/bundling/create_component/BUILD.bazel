load("@rules_angular//src/optimization:index.bzl", "optimize_angular_app")
load("//tools/symbol-extractor:index.bzl", "js_expected_symbol_test")

package(default_visibility = ["//visibility:public"])

optimize_angular_app(
    name = "bundles",
    srcs = [
        "main.ts",
    ],
    env = {
        "NG_BUILD_MANGLE": "0",
    },
    deps = [
        "//:node_modules/rxjs",
        "//:node_modules/tslib",
        "//packages/core/test/bundling:node_modules/@angular/build",
        "//packages/core/test/bundling:node_modules/@angular/common",
        "//packages/core/test/bundling:node_modules/@angular/core",
        "//packages/core/test/bundling:node_modules/@angular/platform-browser",
    ],
)

js_expected_symbol_test(
    name = "symbol_test",
    bundles_dir = ":bundles",
    golden = ":bundle.golden_symbols.json",
)
