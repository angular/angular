# Work with translation files

{@a ng-xi18n}
{@a ng-xi18n-options}
{@a translate}

After preparing a template for translation, use the [`extract-i18n`][AioCliExtractI18n] Angular CLI command to extract the marked text in the template into a *source language* file.

The marked text includes text marked with `i18n` and attributes marked with `i18n-`*attribute* as described in the previous section.
Follow these steps:

1.  [Extract the source language file][AioGuideI18nCommonTranslationFilesExtractTheSourceLanguageFile].
    Optionally, change the location, format, and name.
1.  [Create a translation file for each language][AioGuideI18nCommonTranslationFilesCreateATranslationFileForEachLanguage] by copying the source language file.
1.  [Translate each translation file][AioGuideI18nCommonTranslationFilesTranslateEachTranslationFile].
1.  [Translate plurals and alternate expressions][AioGuideI18nCommonTranslationFilesTranslatePluralsAndAlternateExpressions] separately.

### Extract the source language file

{@a create-source}

To extract the source language file, open a terminal window, change to the root directory of your application project, and run the following CLI command:

<code-example language="sh">
ng extract-i18n
</code-example>

The `extract-i18n` command creates a source language file named `messages.xlf` in the root directory of your project using the [XML Localization Interchange File Format (XLIFF, version 1.2)][WikipediaWikiXliff].

Use the following [`extract-i18n` command options][AioCliExtractI18n] to change the source language file location, format, and file name:

*   `--output-path`: Change the location.
*   `--format`: Change the format.
*   `--outFile`: Change the file name.

<div class="alert is-helpful">

**Note**: The `--i18n-locale` option is deprecated.
Angular 9 uses the source locale configured in the [workspace configuration][AioGuideWorkspaceConfig] file (`angular.json`) of your application.

</div>

#### Change the source language file location

To create a file in the `src/locale` directory, specify the output path as an option.
The following example specifies the output path as an option.

<code-example language="sh">
ng extract-i18n --output-path src/locale
</code-example>

#### Change the source language file format

{@a other-formats}

The `extract-i18n` command writes files in the following translation formats.

*   XLIFF 1.2 (default)
*   XLIFF 2
*   [XML Message Bundle (XMB)][UnicodeCldrDevelopmentDevelopmentProcessDesignProposalsXmb]
*   JSON
*   [ARB][GithubGoogleAppResourceBundleWikiApplicationresourcebundlespecification]

Specify the translation format explicitly with the `--format` command option.
The following example demonstrates several translation formats.

<code-example language="sh">
ng extract-i18n --format=xlf
ng extract-i18n --format=xlf2
ng extract-i18n --format=xmb
ng extract-i18n --format=json
ng extract-i18n --format=arb
</code-example>

<div class="alert is-helpful">

XLIFF files use the extension `.xlf`.
The XMB format generates `.xmb` source language files but uses`.xtb` (XML Translation Bundle or XTB) translation files.

</div>

#### Change the source language file name

To change the name of the source language file generated by the extraction tool, use
the `--outFile` command option:

<code-example language="sh">
ng extract-i18n --out-file source.xlf
</code-example>

### Create a translation file for each language

{@a localization-folder}

The `ng extract-i18n` command (with no options) generates a source language file named `messages.xlf` in the project `src` folder.
Create *translation* files for each language by copying the source language file.
To avoid confusion with multiple translations, you should organize the language translation files by locale in a dedicated `locale` folder under `src/`.
Use a filename extension that matches the associated locale, such as `messages.fr.xlf`.

For example, to create a French translation file, follow these steps:

1.  Make a copy of the `messages.xlf` source language file.
1.  Put the copy in the `src/locale` folder.
1.  Rename the copy to `messages.fr.xlf` for the French language (`fr`) translation.
    Send this translation file to the translator.

Repeat the above steps for each language you want to add to your application.

### Translate each translation file

{@a translate-text-nodes}

Unless you are fluent in the language and have the time to edit translations, you would likely send each translation file to a translator, who would then use an XLIFF file editor to create and edit the translation.

To demonstrate this process, review the `messages.fr.xlf` file in the <live-example></live-example>.  The live example includes a French translation for you to edit without a special XLIFF editor or knowledge of French.
Complete the following actions.

1.  Open `messages.fr.xlf` and find the first `<trans-unit>` element.
    This is a *translation unit*, also known as a *text node*, representing the translation of the `<h1>` greeting tag that was previously marked with the `i18n` attribute:
    
    > <code-example path="i18n/doc-files/messages.fr.xlf.html" region="translated-hello-before" header="src/locale/messages.fr.xlf (&lt;trans-unit&gt;)"></code-example>
    
    > The `id="introductionHeader"` is a [custom ID][AioGuideI18nOptionalManageMarkedText], but without the `@@` prefix required in the source HTML.
    
2.  Duplicate the `<source>...</source>` element in the text node, rename it to `target`, and then replace its content with the French text:
    
    > <code-example path="i18n/doc-files/messages.fr.xlf.html" region="translated-hello" header="src/locale/messages.fr.xlf (&lt;trans-unit&gt;, after translation)"></code-example>
    
    > In a more complex translation, the information and context in the [description and meaning elements][AioGuideI18nCommonPrepareAddHelpfulDescriptionsAndMeanings] described previously would help you choose the right words for translation.
    
3.  Translate the other text nodes.
    The following example displays the way to translate.
    
    > <code-example path="i18n/doc-files/messages.fr.xlf.html" region="translated-other-nodes" header="src/locale/messages.fr.xlf (&lt;trans-unit&gt;)"></code-example>
    
    <div class="alert is-important">
    
    Don't change the IDs for translation units.
    Each `id` is generated by Angular and depends on the content of the template text and its assigned meaning.
    If you change either the text or the meaning, then the `id` changes.
    For more about managing text updates and IDs, see [custom IDs][AioGuideI18nOptionalManageMarkedText].
    
    </div>
    
### Translate plurals and alternate expressions

{@a translate-plural-select}

The [`plural` and `select` ICU expressions][AioGuideI18nCommonPrepareMarkPluralsAndAlternatesForTranslation] are extracted as additional messages, so you must translate them separately.

#### Translate plurals

{@a translate-plural}

To translate a `plural`, translate the ICU format match values.

*   `just now`
*   `one minute ago`
*   `<x id="INTERPOLATION" equiv-text="{{minutes}}"/> minutes ago`
    
The following example displays the way to translate.

<code-example path="i18n/doc-files/messages.fr.xlf.html" region="translated-plural" header="src/locale/messages.fr.xlf (&lt;trans-unit&gt;)"></code-example>

Add or remove plural cases as needed for each language.

<div class="alert is-helpful">

For language plural rules, see [CLDR plural rules][GithubUnicodeOrgCldrStagingChartsLatestSupplementalLanguagePluralRulesHtml].

</div>

#### Translate alternate expressions

{@a translate-select}

Angular also extracts alternate `select` ICU expressions as separate translation units.
The following example displays a `select` ICU expression in the component template.

<code-example path="i18n/src/app/app.component.html" region="i18n-select" header="src/app/app.component.html"></code-example>

In this example, Angular extracts the expression into two translation units.
The first contains the text outside of the `select` clause, and uses a placeholder for `select` (`<x id="ICU">`):

<code-example path="i18n/doc-files/messages.fr.xlf.html" region="translate-select-1" header="src/locale/messages.fr.xlf (&lt;trans-unit&gt;)"></code-example>

<div class="alert is-important">

When you translate the text, move the placeholder if necessary, but don't remove it.
If you remove the placeholder, the ICU expression is removed from your translated application.

</div>

The following example displays the second translation unit that contains the `select` clause.

<code-example path="i18n/doc-files/messages.fr.xlf.html" region="translate-select-2" header="src/locale/messages.fr.xlf (&lt;trans-unit&gt;)"></code-example>

The following example displays both translation units after translation is complete.

<code-example path="i18n/doc-files/messages.fr.xlf.html" region="translated-select" header="src/locale/messages.fr.xlf (&lt;trans-unit&gt;)"></code-example>

#### Translate nested expressions

{@a translate-nested}

Angular treats a nested expression in the same manner as an alternate expression.  Angular extracts the expression into two translation units. 
The following example displays the first translation unit that contains the text outside of the nested expression.

<code-example path="i18n/doc-files/messages.fr.xlf.html" region="translate-nested-1" header="src/locale/messages.fr.xlf (&lt;trans-unit&gt;)"></code-example>

The following example displays the second translation unit that contains the complete nested expression.

<code-example path="i18n/doc-files/messages.fr.xlf.html" region="translate-nested-2" header="src/locale/messages.fr.xlf (&lt;trans-unit&gt;)"></code-example>

The following example displays both translation units after translating.

<code-example path="i18n/doc-files/messages.fr.xlf.html" region="translate-nested" header="src/locale/messages.fr.xlf (&lt;trans-unit&gt;)"></code-example>

<!-- links -->

[AioGuideI18nOptionalManageMarkedText]: guide/i18n-optional-manage-marked-text "Manage marked text with custom IDs | Angular"

[AioGuideI18nCommonPrepareAddHelpfulDescriptionsAndMeanings]: guide/i18n-common-prepare#add-helpful-descriptions-and-meanings "Add helpful descriptions and meanings - Common Internationalization task #4: Prepare templates for translations | Angular"

[AioGuideI18nCommonPrepareMarkPluralsAndAlternatesForTranslation]: guide/i18n-common-prepare#mark-plurals-and-alternates-for-translation "Mark plurals and alternates for translation - Common Internationalization task #4: Prepare templates for translations | Angular"

[AioGuideI18nCommonTranslationFilesCreateATranslationFileForEachLanguage]: guide/i18n-common-translation-files#create-a-translation-file-for-each-language "Create a translation file for each language - Work with translation files | Angular"
[AioGuideI18nCommonTranslationFilesExtractTheSourceLanguageFile]: guide/i18n-common-translation-files#extract-the-source-language-file "Extract the source language file - Work with translation files | Angular"
[AioGuideI18nCommonTranslationFilesTranslateEachTranslationFile]: guide/i18n-common-translation-files#translate-each-translation-file "Translate each translation file - Work with translation files | Angular"
[AioGuideI18nCommonTranslationFilesTranslatePluralsAndAlternateExpressions]: guide/i18n-common-translation-files#translate-plurals-and-alternate-expressions "Translate plurals and alternate expressions - Work with translation files | Angular"

[AioCliExtractI18n]: cli/extract-i18n "ng extract-i18n | CLI | Angular"

[AioGuideWorkspaceConfig]: guide/workspace-config "Angular workspace configuration | Angular"

<!-- external links -->

[GithubGoogleAppResourceBundleWikiApplicationresourcebundlespecification]: https://github.com/google/app-resource-bundle/wiki/ApplicationResourceBundleSpecification "ApplicationResourceBundleSpecification | google/app-resource-bundle | GitHub"

[GithubUnicodeOrgCldrStagingChartsLatestSupplementalLanguagePluralRulesHtml]: https://unicode-org.github.io/cldr-staging/charts/latest/supplemental/language_plural_rules.html "Language Plural Rules - CLDR Charts | Unicode | GitHub"

[UnicodeCldrDevelopmentDevelopmentProcessDesignProposalsXmb]: http://cldr.unicode.org/development/development-process/design-proposals/xmb "XMB | CLDR - Unicode Common Locale Data Repository | Unicode"

[WikipediaWikiXliff]: https://en.wikipedia.org/wiki/XLIFF "XLIFF | Wikipedia"

<!-- end links -->

@reviewed 2021-08-23
