<div class="header">Hydration (Hidrasiya)</div>
<div class="description">
  Hydration (Hidrasiya) — server tərəfindən render edilmiş (server-side rendered) tətbiqi müştəri
  (client) tərəfində bərpa edən prosesdir.

  <p>
    Bu demo Angular-ın Hydration (Hidrasiya) strategiyalarını nümayiş etdirir; bu, sizə şəbəkə
    gecikməsini (network latency) simulyasiya etməyə və müxtəlif komponentlərin konfiqurasiya
    edilmiş tətikləyicilər (triggers) əsasında necə hidratasiya olunduğunu müşahidə etməyə imkan
    verir.
  </p>
</div>

<div class="demo-container">
  <div class="max-width-wrapper">
    <div class="main-layout">
      <div class="sidebar">
        <div class="card config-card">
          <h3 class="sidebar-title font-mono">
            <docs-icon>schedule</docs-icon>
            Simulyasiya Konfiqurasiyası
          </h3>

          <div class="config-controls">
            <div class="control-group">
              <div class="label-row">
                <label>Şəbəkə Gecikməsi (Network Latency)</label>
                <span class="latency-value font-mono">{{ latency() }}ms</span>
              </div>
              <input
                type="range"
                min="0"
                max="4000"
                step="100"
                [value]="latency()"
                (input)="updateLatency($event)"
                class="range-input"
              />
            </div>

            <button
              (click)="resetSimulation()"
              [disabled]="isSimulationRunning()"
              class="btn-reset"
            >
              <docs-icon>refresh</docs-icon>
              Həyat Dövrünü (Lifecycle) Sıfırla
            </button>
          </div>
        </div>

        <div class="terminal">
          <h3 class="terminal-title font-mono">Hydration Engine Log (Hidrasiya Motoru Jurnalı)</h3>
          <div class="terminal-body font-mono custom-scrollbar">
            @for (evt of eventQueue(); track $index) {
              <div class="log-entry animate-in">
                <span class="log-index">0{{ $index + 1 }}</span>
                <span class="log-tag">hadisə:</span>
                <span class="log-msg">{{ evt }}</span>
              </div>
            }
            @if (eventQueue().length === 0) {
              <div class="log-placeholder">Tətbiqin başladılması (bootstrap) gözlənilir...</div>
            }
          </div>
        </div>
      </div>

      <div class="simulator-stage">
        <div class="browser-window">
          <div class="browser-header">
            <div class="window-controls">
              <div class="dot-win"></div>
              <div class="dot-win"></div>
              <div class="dot-win"></div>
            </div>
            <div class="address-bar font-mono">
              <docs-icon>lock</docs-icon>
              angular.dev/hydration-strategies
            </div>
          </div>

          <div class="viewport">
            @if (currentState() === 'Server-Side Rendering...') {
              <div class="ssr-overlay animate-fade">
                <div class="ssr-spinner">
                  <div class="spinner-outer"></div>
                  <div class="spinner-inner"></div>
                </div>
                <p class="ssr-title">SSR Markup (Nişanlanma) Yaradılır...</p>
              </div>
            }

            <div class="viewport-flex">
              <div class="viewport-header">
                <div class="header-text">
                  <h4 class="viewport-title">Komponent Strategiyaları</h4>
                  <p class="viewport-subtitle">
                    Eager (təcili) və deferred (təxirə salınmış) hidrasiya tətikləyicilərinin
                    qarışığı.
                  </p>
                </div>
                <div class="viewport-stats">
                  <div class="stats-label">Əsas Tətbiq</div>
                  <div class="stats-value font-tabular">{{ progress() }}%</div>
                </div>
              </div>

              <div class="component-grid">
                @for (card of [card1(), card2(), card3(), card4()]; track $index) {
                  <div
                    (click)="handleCardClick(card.id)"
                    class="component-card transition-all"
                    [class]="{
                      'interactive': isInteractive() || card.strategy === 'on-interaction',
                      'static': !isInteractive() && card.strategy !== 'on-interaction',
                      'active-card': card.clickCount > 0,
                      'dashed-border': !card.isHydrated,
                    }"
                  >
                    <div class="card-top">
                      <div
                        class="icon-box transition-all"
                        [class]="card.isHydrated ? 'icon-hydrated' : 'icon-static'"
                      >
                        @if (card.isHydrating) {
                          <div class="loading-spinner"></div>
                        } @else {
                          <docs-icon>water_drop</docs-icon>
                        }
                      </div>
                      @if (card.clickCount > 0) {
                        <div class="click-badge font-tabular animate-zoom">
                          <span class="badge-label">KLİKLƏR:</span> {{ card.clickCount }}
                        </div>
                      }
                    </div>

                    <div class="card-body">
                      <h5 class="card-title">{{ card.title }}</h5>
                      <p class="card-desc">{{ card.description }}</p>
                    </div>

                    <div class="card-footer">
                      @if (card.isHydrating) {
                        <div class="tag tag-deferred animate-slide-in">
                          <span class="tag-dot spin"></span>
                          Hidratasiya olunur...
                        </div>
                      } @else if (!card.isHydrated) {
                        <div class="tag tag-deferred">
                          <span class="tag-dot pulse"></span>
                          Statik (Static)
                        </div>
                      } @else {
                        <div class="tag tag-hydrated animate-slide-in">
                          <span class="tag-dot"></span>
                          Hidratasiya olundu (Hydrated)
                        </div>
                      }
                    </div>

                    @if (card.syntax) {
                      <div
                        class="syntax-badge font-mono"
                        [class]="card.isHydrated ? 'syntax-inactive' : 'syntax-active'"
                      >
                        {{ card.syntax }}
                      </div>
                    }
                  </div>
                }
              </div>
            </div>
          </div>

          <div class="lifecycle-progress-bar">
            <div class="progress-fill transition-all" [style.width.%]="progress()"></div>
          </div>
        </div>
      </div>
    </div>

    <div class="explainer-grid">
      <div class="explainer-item">
        <h5 class="explainer-title">
          <span class="dot-red"></span> Eager Hydration (Təcili Hidrasiya)
        </h5>
        <p class="explainer-text">
          Vacib komponentlər (naviqasiya və ya görünən ilkin hissə kimi) əsas tətbiq paketi (bundle)
          hazır olan kimi hidratasiya olunur.
        </p>
      </div>
      <div class="explainer-item">
        <h5 class="explainer-title">
          <span class="dot-violet"></span> Incremental Hydration (Artımlı Hidrasiya)
        </h5>
        <p class="explainer-text">
          Kritik olmayan elementlər üçün JS icrasını gecikdirmək məqsədilə
          <code>on interaction</code> və ya <code>on timer</code> kimi hidrasiya tətikləyicilərindən
          istifadə edin.
        </p>
      </div>
      <div class="explainer-item">
        <h5 class="explainer-title">
          <span class="dot-green"></span> Event Replay (Hadisənin Təkrarı)
        </h5>
        <p class="explainer-text">
          İstifadəçi klikləri heç vaxt itmir. Angular "Statik" faza zamanı hadisələri qeyd edir və
          hidratasiya olunduqdan sonra onları yenidən işə salır.
        </p>
      </div>
    </div>
  </div>
  <button
    class="docs-primary-btn"
    [attr.text]="'Hydration (Hidrasiya) haqqında daha çox öyrənin'"
    routerLink="/guide/hydration"
  >
    Hydration (Hidrasiya) haqqında daha çox öyrənin
  </button>
</div>
